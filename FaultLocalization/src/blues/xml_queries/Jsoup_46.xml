<?xml version="1.0" encoding="ISO-8859-1"?>
<bugrepository name="Defects4J">
<bug id="Jsoup_46" link="https://github.com/jhy/jsoup/issues/523">
<buginformation>
<summary>escape mode  xhtml  longer  falls  back  numeric  escapes  can  cause  replacement  output</summary>
<description>been using escape mode xhtml with soup avoid encoding things which don from perspective need encoded like egrave utf document for example while upgrading from soup however noticed problem with shift jis related test have here simplified reduced version package test import java byte array input stream import java input stream import java nio charset charset import org jsoup jsoup import org jsoup nodes document import org jsoup nodes entities escape mode import org junit assert import org junit test public class shift jis test test public void test shift jis roundtrip throws exception string input html head meta http equiv content type content text html charset shift jis head body before nbsp after body html input stream new byte array input stream input get bytes charset for name ascii document doc jsoup parse null http example com doc output settings escape mode escape mode xhtml string output new string doc html get bytes doc output settings charset doc output settings charset system out println output assert assert false should not have contained output contains assert assert true should have contained nbsp output contains output contains nbsp under soup the body the output this test before after which looks expected when rendered firefox where under before after assume the issue here that asked soup escape only xhtml characters not nbsp and producing charset where assume there character represent non breaking space the upshot this that result upgrading soup end with replaced for what used shown non breaking space seems like the old behaviour was fall back providing escaped numeric character odd there valid character for that shift jis but still rendered correctly from perspective the old behaviour was better there any way can reinstated escape mode provided for obviously using escape mode base instead escape mode xhtml possible workaround however would really prefer not have characters unnecessarily escaped possible the text was updated successfully but these errors were encountered jhy closed this 3ba 88d jul 2015 copy link owner jhy commented jul 2015 thanks this issue was specific tags xhtml encoding fixed always outputting that circumstance even the charset does support nbsp natively aid visibility the output zazi added commit dswarm jsoup that referenced this issue oct 2015 fixed nbsp for xhtml shift 9db 79f fixes jhy 523 sign for free join this conversation git hub already have account sign comment assignees one assigned labels none yet projects none yet milestone milestone linked pull requests successfully merging pull request may close this issue none yet participants</description>
</buginformation>
<fixedfiles>
<file>org.jsoup.nodes.Entities</file>
</fixedfiles>
</bug>
</bugrepository>
