<?xml version="1.0" encoding="ISO-8859-1"?>
<bugrepository name="Defects4J">
<bug id="JacksonDatabind_69" link="https://github.com/FasterXML/jackson-databind/issues/1476">
<buginformation>
<summary>wrong  constructor  picked  when  deserializing  object</summary>
<description>discovered issue with jackson and jackson when several constructors have parameters annotated with json property but only one annotated with json creator here test case reproduce import static org junit assert assert equals import java exception import org junit test import com fasterxml jackson annotation json creator import com fasterxml jackson annotation json property import com fasterxml jackson core json parse exception import com fasterxml jackson databind object mapper public class test jackson public static final class simple pojo private final int int field private final string string field public simple pojo json property int field int int field this int field empty public simple pojo json property string field string string field this string field json creator public simple pojo json property int field int int field json property string field string string field this int field int field this string field string field public int get int field return int field public string get string field return string field test public void test jackson throws json parse exception exception object mapper mapper new object mapper simple pojo pojo mapper read value int field string field foo simple pojo class assert equals pojo get int field assert equals foo pojo get string field this test throws the following exception com fasterxml jackson databind json mapping exception could not find creator property with name string field class org apache drill test jackson simple pojo source int field string field foo line column com fasterxml jackson databind json mapping exception from json mapping exception java 270 com fasterxml jackson databind deserialization context report mapping exception deserialization context java 1234 com fasterxml jackson databind deser bean deserializer factory add bean props bean deserializer factory java 551 com fasterxml jackson databind deser bean deserializer factory build bean deserializer bean deserializer factory java 226 com fasterxml jackson databind deser bean deserializer factory create bean deserializer bean deserializer factory java 141 com fasterxml jackson databind deser deserializer cache create deserializer deserializer cache java 403 com fasterxml jackson databind deser deserializer cache create deserializer deserializer cache java 349 com fasterxml jackson databind deser deserializer cache create and cache deserializer cache java 264 com fasterxml jackson databind deser deserializer cache create and cache value deserializer deserializer cache java 244 com fasterxml jackson databind deser deserializer cache find value deserializer deserializer cache java 142 com fasterxml jackson databind deserialization context find root value deserializer deserialization context java 476 com fasterxml jackson databind object mapper find root deserializer object mapper java 3899 com fasterxml jackson databind object mapper read map and close object mapper java 3794 com fasterxml jackson databind object mapper read value object mapper java 2842 test jackson test jackson test jackson java sun reflect native method accessor impl invoke native method sun reflect native method accessor impl invoke native method accessor impl java sun reflect delegating method accessor impl invoke delegating method accessor impl java java lang reflect method invoke method java 606 org junit runners model framework method run reflective call framework method java org junit internal runners model reflective callable run reflective callable java org junit runners model framework method invoke explosively framework method java org junit internal runners statements invoke method evaluate invoke method java org junit runners parent runner run leaf parent runner java 325 org junit runners block unit class runner run child block unit class runner java org junit runners block unit class runner run child block unit class runner java org junit runners parent runner run parent runner java 290 org junit runners parent runner schedule parent runner java org junit runners parent runner run children parent runner java 288 org junit runners parent runner access 000 parent runner java org junit runners parent runner evaluate parent runner java 268 org junit runners parent runner run parent runner java 363 org eclipse jdt internal junit runner unit test reference run unit test reference java org eclipse jdt internal junit runner test execution run test execution java org eclipse jdt internal junit runner remote test runner run tests remote test runner java 459 org eclipse jdt internal junit runner remote test runner run tests remote test runner java 678 org eclipse jdt internal junit runner remote test runner run remote test runner java 382 org eclipse jdt internal junit runner remote test runner main remote test runner java 192 after some debugging looks like that basic deserializer factory add deserializer constructors looping over all the constructors and not favoring explicit constructor over non explicit one actually don know what should the expected behavior should jackson fail when two constructors are annotated should jackson favor the one annotated with json creator both options look reasonable and actually removing one the constructors the text was updated successfully but these errors were encountered copy link member cowtowncoder commented dec 2016 edited laurentgo thank you for reporting this think explicit json creator should have priority this what done with most other accessors implicit discovery may overridden explicit annotation should fixed for but may take while since will vacation starting tomorrow until january cowtowncoder added active labels dec 2016 copy link author laurentgo commented dec 2016 sounds good would backported branch this branch definitively closed copy link member cowtowncoder commented dec 2016 laurentgo not yet closed unless fix particularly intrusive will probably backport for well copy link member cowtowncoder commented jan 2017 interesting can reproduce with code exactly but almost any change like commenting out just one arg constructors replacing getters with public fields will make test pass cowtowncoder removed active labels jan 2017 cowtowncoder added this the milestone jan 2017 cowtowncoder closed this 44600d jan 2017 copy link author laurentgo commented jan 2017 thanks for fixing this yes agree that the test case very fragile but that was the best could come with that time sign for free join this conversation git hub already have account sign comment assignees one assigned labels none yet projects none yet milestone linked pull requests successfully merging pull request may close this issue none yet participants</description>
</buginformation>
<fixedfiles>
<file>com.fasterxml.jackson.databind.deser.impl.CreatorCollector</file>
</fixedfiles>
</bug>
</bugrepository>
