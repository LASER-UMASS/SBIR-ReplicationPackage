<?xml version="1.0" encoding="ISO-8859-1"?>
<bugrepository name="Defects4J">
<bug id="Math_26" link="https://issues.apache.org/jira/browse/MATH-836">
<buginformation>
<summary>fraction  double  int  constructor  strange  behaviour</summary>
<description>the  fraction  constructor  fraction  double  int  takes  double  value  and  int  maximal  denominator  and  approximates  fraction  when  the  double  value  large  negative  number  with  many  digits  the  fractional  part  and  the  maximal  denominator  big  positive  integer  the  100  000s  two  distinct  bugs  can  manifest  the  constructor  returns  positive  fraction  calling  fraction  33655  1677817278  371880  returns  the  fraction  410517235  243036  which  both  has  the  wrong  sign  and  far  away  from  the  absolute  value  the  given  value  the  constructor  does  not  manage  reduce  the  fraction  properly  calling  fraction  43979  60679604749  366081  returns  the  fraction  1651878166  256677  which  should  have  been  reduced  24654898  3831  have  yet  not  found  solution  the  constructor  looks  like  this  public  fraction  double  value  int  maxdenominator  throws  fractionconversionexception  this  value  maxdenominator  100  increasing  the  100  value  max  iterations  does  not  fix  the  problem  for  all  cases  changing  the  value  the  epsilon  maximum  allowed  error  something  small  does  not  work  either  this  breaks  the  tests  fractiontest  the  problem  not  neccissarily  that  the  algorithm  unable  approximate  fraction  correctly  solution  where  fractionconversionexception  had  been  thrown  each  these  examples  would  probably  the  best  solution  improvement  the  approximation  algorithm  turns  out  hard  find  this  bug  has  been  found  when  trying  explore  the  idea  axiom  based  testing  http  bldl  uib  testing  html  attached  java  test  class  fractiontestbyaxiom  junit  goes  into  org  apache  commons  math  fraction  which  shows  these  bugs  through  simplified  approach  this  kind  testing  and  text  file  describing  some  the  value  maxdenominator  combinations  which  causes  one  these  failures  never  specified  the  documentation  that  the  fraction  class  guarantees  that  completely  reduced  rational  numbers  are  constructed  but  comment  inside  the  equals  method  claims  that  since  fractions  are  always  lowest  terms  numerators  and  can  compared  directly  for  equality  seems  like  this  the  intention</description>
</buginformation>
<fixedfiles>
<file>org.apache.commons.math3.fraction.Fraction</file>
</fixedfiles>
</bug>
</bugrepository>
