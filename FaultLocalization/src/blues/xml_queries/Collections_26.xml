<?xml version="1.0" encoding="ISO-8859-1"?>
<bugrepository name="Defects4J">
<bug id="Collections_26" link="https://issues.apache.org/jira/browse/COLLECTIONS-576">
<buginformation>
<summary>multi key  subclassing  has  deserialization  problem  since  collections  266  either  declare  protected read resolve multi key  must  final</summary>
<description>multikey  from  collections  provides  transient  hashcode  and  private  readresolve  resolve  collections  266  issue  with  multikey  when  serialized  deserialized  via  rmi  unfortunately  the  solution  does  not  work  case  subclassing  readresolve  multikey  should  declared  protected  readresolve  called  during  deserialization  the  subclass  otherwise  multikey  must  final  avoid  such  subclassing  testcase  multikeyserializationtest  java  package  ivu  test  common  collections  import  static  org  junit  assert  assertequals  import  java  bytearrayinputstream  import  java  bytearrayoutputstream  import  java  ioexception  import  java  objectinputstream  import  java  objectoutputstream  import  org  apache  commons  collections  keyvalue  multikey  import  org  junit  test  public  class  multikeyserializationtest  test  suppresswarnings  unchecked  public  void  testreadresolveequalhashcode  throws  ioexception  classnotfoundexception  class  multikey  extends  multikey  private  static  final  long  serialversionuid  1928896152249821416l  public  multikey  key  key  super  key  key  public  getfirst  return  getkey  public  getsecond  return  getkey  fixme  multikey  should  either  declare  protected  readresolve  must  final  multikey  string  string  one  new  multikey  bla  blub  system  out  println  one  hashcode  bytearrayoutputstream  byteout  new  bytearrayoutputstream  objectoutputstream  out  new  objectoutputstream  byteout  out  writeobject  one  out  close  byte  serialized  byteout  tobytearray  bytearrayinputstream  bytein  new  bytearrayinputstream  serialized  objectinputstream  new  objectinputstream  bytein  multikey  string  string  two  multikey  string  string  readobject  system  out  println  two  hashcode  assertequals  hashcode  must  equal  please  check  for  protected  readresolve  multikey  one  hashcode  two  hashcode  fix  multikey  java  274  274  only  stable  for  the  same  process  return  the  instance  with  recalculated  hash  code  private  object  readresolve  protected  object  readresolve  calculatehashcode  keys  return  this</description>
</buginformation>
<fixedfiles>
<file>org.apache.commons.collections4.keyvalue.MultiKey</file>
</fixedfiles>
</bug>
</bugrepository>
