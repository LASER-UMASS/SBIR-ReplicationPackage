<?xml version="1.0" encoding="ISO-8859-1"?>
<bugrepository name="Defects4J">
<bug id="JacksonDatabind_17" link="https://github.com/FasterXML/jackson-databind/issues/793">
<buginformation>
<summary>read tree  does  not  work  with default typing  enabled  but  type  info  provided</summary>
<description>have enabled default typing and serialized foo entity with type info trying read json tree with mapper read tree json and throws exception exception thread main com fasterxml jackson databind json mapping exception unexpected token start object expected start array need json array contain wrapper array type information for class com fasterxml jackson databind json node source bar bar line column com fasterxml jackson databind json mapping exception from json mapping exception java 148 com fasterxml jackson databind deserialization context wrong token exception deserialization context java 927 com fasterxml jackson databind jsontype impl array type deserializer locate type array type deserializer java 127 com fasterxml jackson databind jsontype impl array type deserializer deserialize array type deserializer java com fasterxml jackson databind jsontype impl array type deserializer deserialize typed from any array type deserializer java com fasterxml jackson databind deser std base node deserializer deserialize with type json node deserializer java 144 com fasterxml jackson databind deser std json node deserializer deserialize with type json node deserializer java com fasterxml jackson databind deser impl type wrapped deserializer deserialize type wrapped deserializer java com fasterxml jackson databind object mapper read map and close object mapper java 3562 com fasterxml jackson databind object mapper read tree object mapper java 2136 test app main app java however disable default typing the same code works fine read tree json does not actually need type info for the root element because works when default typing disabled bar bar but throws the exception when default typing enabled that why looks like bug the same thing happens for value tree foo jackson version full code provided import com fasterxml jackson databind json node import com fasterxml jackson databind mapper feature import com fasterxml jackson databind object mapper import com fasterxml jackson databind serialization feature import java exception public class app public static void main string args throws exception object mapper mapper new object mapper enable default typing works fine with disable default typing enable mapper feature auto detect getters enable mapper feature require setters for getters disable mapper feature use getters setters disable mapper feature can override access modifiers enable serialization feature indent output disable serialization feature fail empty beans foo foo new foo bar string serialized mapper write value string foo bar bar json node json node mapper read tree serialized exception here json node node mapper value tree foo and here public static class foo private string bar public foo public foo string bar this bar bar public string get bar return bar public void set bar string bar this bar bar the text was updated successfully but these errors were encountered copy link member cowtowncoder commented may 2015 thanks tree handling should just ignore default typing trees should represent json exactly this sounds like bug cowtowncoder added this the milestone may 2015 cowtowncoder closed this 143c may 2015 copy link member cowtowncoder commented may 2015 looks like earlier fix for had minor flaw and was not skipping type for json node with standard default typing which the intended behavior one can still force type with custom default typing copy link author gracefulgopher commented may 2015 thanks lot for fast reply and fix waiting for jackson sign for free join this conversation git hub already have account sign comment assignees one assigned labels none yet projects none yet milestone linked pull requests successfully merging pull request may close this issue none yet participants</description>
</buginformation>
<fixedfiles>
<file>com.fasterxml.jackson.databind.ObjectMapper</file>
</fixedfiles>
</bug>
</bugrepository>
