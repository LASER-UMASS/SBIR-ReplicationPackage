<?xml version="1.0" encoding="ISO-8859-1"?>
<bugrepository name="Defects4J">
<bug id="JacksonDatabind_87" link="https://github.com/FasterXML/jackson-databind/issues/1657">
<buginformation>
<summary>deserializes  dates  with  offset  utc  instead  configured  timezone</summary>
<description>prior version dates without time zone time offset 1970 000 were deserialised the time zone set the object mapper starting from these dates are deserialised utc which major breaking change behaviour example object mapper mapper new object mapper mapper set time zone time zone get time zone gmt date date mapper read value 1970 000 java util date class date 1970 000 with jackson date 1970 000 with jackson the text was updated successfully but these errors were encountered copy link member cowtowncoder commented jun 2017 edited hmmh date value with specified timezone asking for trouble agree that most reasonable take would use mapper configured timezone defaulting utc but using whatever override change between versions unfortunate but since test failures were observed this has been effect unspecified behavior copy link contributor author brenuart commented jun 2017 edited luckily had tests for that our side must say this show stopper and for many people suppose relied this behaviour since long transfer called local date time values since dates were reconstructed the local timezone set the mapper they could safely used eventhough they had associated with them even that use case doesn seem 100 valid this change will affect many people and most won notice before production suspect the change caused the fix related the handling the zulu dates haven check yet god feeling both cases through the same path copy link member cowtowncoder commented jun 2017 brenuart yes seems likely related that fix unfortunately jdk date and date format are alas awful things which compounds the issue and can see this being very nasty problem unexpected too fix only seemed affect cases where part value and nothing else but with std date format also being mess possible composes string with uses that format one thing that could help here that test and fix could result release jackson databind micro patch since not sure when would released obviously you have other related tests those would great least maybe could coordinate with fix for this one then trying snapshot against your test suite copy link contributor author brenuart commented jun 2017 have leave work now but can back couple hours don know about your timezone lol micro patch would great indeed can have look your existing tests and see some ours could added what timeframe you expect copy link member cowtowncoder commented jun 2017 brenuart this does not affect directly and have not seen reports others yet think timeline really you typically adoption for later patches kind slow too which good this particular case whenever you get chance great timezone pst seattle usa fwtw btw appreciate your help date time handling royal pita and not area expertise all the help well hugely helpful copy link contributor author brenuart commented jun 2017 edited you already know how fix this issue should have look agree with you date handling nightmare not expert either and certainly don want become one just spent the last weeks fixing stuff applications built with java util date joda java time could work together without too much hassle hence the bunch tests have and gmt copy link contributor author brenuart commented jun 2017 just had look the date deserialisation tests they are nearly all built with the expected date gmt the default the mapper none cover the case where the mapper may configured with another time zone most should probably rewritten make use object mapper configured with timezone other than the default utc this way would have the guarantee the configured timezone actually taken into account every scenarios working this expect first soon can continue the discussion something more concrete need some sleep now copy link member cowtowncoder commented jun 2017 shoot yes can see where this occurs and had spent bit more time with the patch this would have been obvious handling for timezone case does indeed just plop there cowtowncoder changed the title std date format deserializes dates with offset utc instead local timezone std date format deserializes dates with offset utc instead configured timezone jun 2017 cowtowncoder added this the milestone jun 2017 cowtowncoder closed this 0ce jun 2017 copy link member cowtowncoder commented jun 2017 brenuart found the problem and far can see fixed added one simpleish test but obviously that not great coverage yet also turns out that almost got change right comment had added was correct but timezone passed wrong however trying reuse same format for two cases trying too clever and split into separate cases this should avoid potential problems with thread safety too which were present after first change due lazy instantiation first access would win copy link contributor author brenuart commented jun 2017 1657 created with additional test cases brenuart mentioned this issue jun 2017 behaviour custom date format with regards the object mapper default time zone 1661 closed copy link contributor author brenuart commented jun 2017 cowtowncoder any chance could release soon copy link member cowtowncoder commented jun 2017 brenuart could that relatively soon hoping for fix two for some reason getting lots reports now could one before leaving for vacation saturday sign for free join this conversation git hub already have account sign comment assignees one assigned labels none yet projects none yet milestone linked pull requests successfully merging pull request may close this issue none yet participants</description>
</buginformation>
<fixedfiles>
<file>com.fasterxml.jackson.databind.util.StdDateFormat</file>
</fixedfiles>
</bug>
</bugrepository>
