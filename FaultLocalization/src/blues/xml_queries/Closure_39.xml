<?xml version="1.0" encoding="ISO-8859-1"?>
<bugrepository name="Defects4J">
<bug id="Closure_39" link="https://storage.googleapis.com/google-code-archive/v2/code.google.com/closure-compiler/issues/issue-643.json">
<buginformation>
<summary>extern export  with  typedef  can  generate  invalid  externs</summary>
<description>what  steps  will  reproduce  the  problem  create  file  that  has  typedef  and  code  referencing  the  type  def  above  and  below  the  typedef  declaration  run  the  closure  compiler  and  grab  the extern export  string  stored  the  last  result  for  review  have  attached  both  source  and  output  files  displaying  the  issue  what  the  expected  output  what  you  see  instead  the  code  above  the  typedef  references  the  aliased  name  the  typedef  expected  however  the  code  below  the  typedef  tries  embedding  the  body  the  typedef  and  ends  truncating  the  length  too  long  with  quot  quot  this  throws  bad  type  errors  when  compiling  against  this  extern  what  odd  this  only  seems  the  case  when  the  parameter  with  the  type  optional  when  neither  are  optional  embeds  the  types  which  not  big  deal  except  when  types  are  long  they  get  truncated  and  throw  errors  what  version  the  product  are  you  using  what  operating  system  plovr  built  from  revision  3103 6db 24beeb  revision  numbers  for  embedded  closure  tools  closure  library  1374  closure  compiler  1559  closure  templates  please  provide  any  additional  information  below  doesn  look  like  the  optional  source  and  optional  output  examples  match  doh  uploaded  the  wrong  file  sorry  here  fix  essentially  the  same  the  non  optional  but  with  the  prefix  thank  you  much  for  reviewing  this  any  update  reviews  this  issue  thanks  for  reporting  the  issue  don  know  when  someone  will  have  time  fix  have  almost  java  experience  but  going  attempt  fix  quite  important  our  project  any  pointers  where  even  start  what  the  problem  might  the  best  place  start  would  write  test  here  http  code  google  com  closure  compiler  source  browse  trunk  test  com  google  javascript  jscomp extern exports pass test  java  you  can  run  the  test  the  command  line  running  ant  test  dtest  class extern exports pass test  java  with  your  favorite  ide  had  guess  say  that  the  problem typed code generator  java  just  appends  the  type  string  which  invokes  its  string  method  http  code  google  com  closure  compiler  source  browse  trunk  src  com  google  javascript  jscomp typed code generator  java  but  string  meant  for  warning  information  you  really  want  some  other  serialization  format type string  that  will  work  generated  code  there  may  issues  trying  come  with  string  serialization  the  type  that  will  work  and  there  may  other  problems  but  that  where  start  thank  you  kind  sir  turns  out  incompetent  hope  you  guys  can  fix  this  soon  for  the  time  being  will  probably  work  with  parser  instead  what  type  sub  class  typedefs  become  this  issue  was  closed  revision  1761</description>
</buginformation>
<fixedfiles>
<file>com.google.javascript.rhino.jstype.PrototypeObjectType</file>
</fixedfiles>
</bug>
</bugrepository>
